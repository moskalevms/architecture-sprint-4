## Планирование: анализ, идентификация проблем и поиск решений

### Анализ существующих и потенциальных проблемных мест:
  1. MES:
     -   долгое время расчета стоимости изделий (от 2 до 30 минут);
     -   долгое время загрузки первой страницы;
     -   проблемы с отображением заказов в реальном времени
     -   кодовая база сторонней организации, что мешает доработкам и оптимизации
  2. RabbitMQ:
     -   после открытия API, RabbitMQ может не справляться с возросшей нагрузкой - сообщения от MES в CRM могут теряться;
  3. База данных:
     -   только один экземпляр БД для MES и онлайн-магазина, который работает одновременно и на чтение и на запись.
     -   нет репликации и шардирования, что ограничивает масштабируемость
  4. CI/CD:
     -  ручной деплой в release-окружение и в продакшн, что замедляет процесс выпуска обновлений
     -  не предусмотрено интеграционных, контрактных автотестов, что приводит к позднему обнаружению критичных багов и как следствие - к задержкам релиза
  5. Мониторинг:
     - в описании и на схеме не упомянут мониторинг и средства аналитики, значит они отсутствуют. Отсутствие в системе мониторинга и аналитики не позволяет своевременно выявлять узкие и проблемные места.
  6. Процессы:
     - В процессинге заказов не хватает функциональности отслеживания конечного и промежуточных статусов заказа
  7. Онлайн-магазин:
     -  представляет собой монолитное приложение, что после увеличения количества пользователей мешает масштабированию системы, а так же оптимизации релизного процесса.

### Инициативы, которые необходимы для устранения нежелательных ситуаций:

  1. Оптимизация и доработка MES:
     - попробовать оптимизировать запросы к БД, проверить наличие индексов, добавить кэширование;
     - перевести MES на кодовую базу компании;
     - оптимизировать алгоритм расчета стоимости изделий
  2. Оптимизация брокера сообщений:
     - кластеризация и настройка RabbitMQ для увеличения пропускной способности
  3. Оптимизация API MES:
     - настроить backpressure и circuit breaker для API, чтобы синхронизировать скорости обработки данных в CRM и MES
  4. Оптимизация БД:
     - внедрить репликацию БД для разделения нагрузки на чтение и на запись
     - рассмотреть шардирование
  5. Оптимизация CI/CD:
     - автоматизировать деплой в release и продакшн окружения
     - внедрение автоматизированного интеграционного и контрактного тестирования
  6. Мониторинг и аналитика:
     - Настроить мониторинг для элементов системы;
     - Внедрить логирование и аналитику
  7. Доработка функционала:
      - добавить возможность отслеживать промежуточные и конечные статусы заказов.

### Приоритизация инициатив:
  1. Целевая архитектура через полгода:
MES переведен на кодовую базу компании, добавлен кэш, оптимизированы запросы к БД. RabbitMQ заменен на Kafka. БД масштабированы с помощью репликации и шардирования. Внедрен автоматизированный CI/CD с тестированием. Настроен мониторинг и аналитика для всех компонентов системы.
  2. Топ-3 инициатив:
     1. Оптимизация MES - кажется, что наиболее узкое место в системе
     2. Кластеризация и настройка RabbitMQ - так же критичное место системы
     3. Мониторинг и аналитика - без мониторинга и аналитики очень сложно выявлять проблемные места в дальнейшем.
