## Архитектурное решение по трейсингу

### Планирование
Системы, которые необходимо покрыть трейсингом:
Трейсинг необходимо подключить к точкам входа в элементы системы:
  - MES API,
  - CRM API,
  - Shop API
Настроив трейсинг для данных API, мы сможем отследить полную цепочку прохождения запросов между системами.

Места, где может зависнуть заказ:
  - в Shop API во время создания заказа;
  - между Shop API и БД Shop API
  - в процессе получения данных заказа CRM из Shop API
  - во время приема заказа от других продавцов через MES API.
  - во время передачи данных заказа из MES в CRM на брокере сообщений
Данные, которые должны попадать в трейсинг:
  - запросы создания заказа в Shop API;
  - запросы получения данных о заказе от других продавцов; 
  - запросы в БД онлайн-магазина и MES;
  - запросы на получение данных заказа из CRM;
  - отправка и получение сообщений в брокер MES и CRM

### Мотивация
Запуск трейсинга позволит сопровождению компании дешевле, чем расширенное логирование, обнаружить узкие места в системе и своевременно их исправить.
Результат внедрения трейсинга для компании: улучшение пользовательского опыта и уменьшение потерянных или необработанных заказов.

### Предлагаемое решение
Предлагается реализовать трейсинг с помощью Jaeger - попоулярный инструмент трейсинга.
Для реализации трейсинга с помощью Jaeger потребуется подключить сбор телеметрии с API сервисов с помощью OpenTelemetry,
развернуть time-series db для хранения трейсов и настроить Jaeger UI для мониторинга.
Планируемые изменения отображены на схеме компонентов:
[Схема](../schemes/jewerly_c4_model_tracing.drawio)

### Компромиссы
До момента перевода MES на свою кодовую базу, настройка трейсинга на нем может быть нецелесообразна, так как система проприетарная.

### Безопасность
  - не использовать трейсинг на промышленном окружении;
  - настроить аутентификацию для входа в Jaeger UI - зайти в систему трейсинга могут только сотрудники с ролью "Поддержка".
